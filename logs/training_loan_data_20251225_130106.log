Starting training on 'loan_data' dataset...
Number of features (actions): 13
------------------------------
Episode  100 | Feature: previous_loan_defaults_on_file | Reward:   0.1433 | Acc: 0.7000 | DPG: 0.1172 | Loss:   0.1636
Episode  200 | Feature: person_home_ownership | Reward:   0.0500 | Acc: 0.7733 | DPG: 0.2625 | Loss:   0.0953
Episode  300 | Feature: loan_percent_income  | Reward:   0.2167 | Acc: 0.7833 | DPG: 0.0576 | Loss:   0.0310
Episode  400 | Feature: loan_percent_income  | Reward:   0.2033 | Acc: 0.7567 | DPG: 0.1372 | Loss:   0.0449
Episode  500 | Feature: loan_percent_income  | Reward:   0.2100 | Acc: 0.7267 | DPG: 0.1615 | Loss:   0.0475
Episode  600 | Feature: loan_percent_income  | Reward:   0.1883 | Acc: 0.7700 | DPG: 0.0316 | Loss:   0.0046
Episode  700 | Feature: loan_percent_income  | Reward:   0.1400 | Acc: 0.7833 | DPG: 0.1815 | Loss:   0.0025
Episode  800 | Feature: loan_percent_income  | Reward:   0.1933 | Acc: 0.7633 | DPG: 0.0908 | Loss:   0.0146
Episode  900 | Feature: loan_percent_income  | Reward:   0.1617 | Acc: 0.7933 | DPG: 0.1170 | Loss:   0.0194
Episode 1000 | Feature: loan_percent_income  | Reward:   0.1400 | Acc: 0.7767 | DPG: 0.0661 | Loss:   0.0661
Episode 1100 | Feature: loan_percent_income  | Reward:   0.1933 | Acc: 0.7967 | DPG: 0.1513 | Loss:   0.0162
Episode 1200 | Feature: loan_percent_income  | Reward:   0.1700 | Acc: 0.7800 | DPG: 0.0771 | Loss:   0.0064
Episode 1300 | Feature: loan_percent_income  | Reward:   0.1700 | Acc: 0.7500 | DPG: 0.0877 | Loss:   0.0047
Episode 1400 | Feature: loan_percent_income  | Reward:   0.1967 | Acc: 0.7600 | DPG: 0.0811 | Loss:   0.0140
Episode 1500 | Feature: loan_int_rate        | Reward:   0.0483 | Acc: 0.8633 | DPG: 0.1189 | Loss:   0.2017
Episode 1600 | Feature: loan_percent_income  | Reward:   0.2200 | Acc: 0.7567 | DPG: 0.2082 | Loss:   0.0083
Episode 1700 | Feature: loan_percent_income  | Reward:   0.1600 | Acc: 0.7867 | DPG: 0.1801 | Loss:   0.0010
Episode 1800 | Feature: loan_percent_income  | Reward:   0.2017 | Acc: 0.8000 | DPG: 0.2150 | Loss:   0.0059
Episode 1900 | Feature: loan_percent_income  | Reward:   0.2150 | Acc: 0.7433 | DPG: 0.0522 | Loss:   0.0045
Episode 2000 | Feature: previous_loan_defaults_on_file | Reward:   0.1417 | Acc: 0.7133 | DPG: 0.0476 | Loss:   0.3345
Episode 2100 | Feature: previous_loan_defaults_on_file | Reward:   0.1133 | Acc: 0.7367 | DPG: 0.0718 | Loss:   0.1377
Episode 2200 | Feature: previous_loan_defaults_on_file | Reward:   0.1167 | Acc: 0.7500 | DPG: 0.0873 | Loss:   0.1602
Episode 2300 | Feature: previous_loan_defaults_on_file | Reward:   0.1217 | Acc: 0.7433 | DPG: 0.0597 | Loss:   0.1137
Episode 2400 | Feature: loan_percent_income  | Reward:   0.1750 | Acc: 0.7833 | DPG: 0.1503 | Loss:   0.0167
Episode 2500 | Feature: previous_loan_defaults_on_file | Reward:   0.1367 | Acc: 0.7167 | DPG: 0.0894 | Loss:   0.3658
Episode 2600 | Feature: loan_percent_income  | Reward:   0.1633 | Acc: 0.7900 | DPG: 0.0688 | Loss:   0.0040
Episode 2700 | Feature: loan_int_rate        | Reward:   0.0417 | Acc: 0.8667 | DPG: 0.1046 | Loss:   0.1407
Episode 2800 | Feature: loan_int_rate        | Reward:   0.1033 | Acc: 0.8667 | DPG: 0.0707 | Loss:   0.3124
Episode 2900 | Feature: loan_percent_income  | Reward:   0.1500 | Acc: 0.7733 | DPG: 0.0878 | Loss:   0.0026
Episode 3000 | Feature: loan_percent_income  | Reward:   0.2117 | Acc: 0.7500 | DPG: 0.0761 | Loss:   0.0049
Episode 3100 | Feature: loan_percent_income  | Reward:   0.1867 | Acc: 0.7567 | DPG: 0.1111 | Loss:   0.0048
Episode 3200 | Feature: loan_percent_income  | Reward:   0.2217 | Acc: 0.7467 | DPG: 0.1882 | Loss:   0.0042
Episode 3300 | Feature: loan_percent_income  | Reward:   0.2300 | Acc: 0.7267 | DPG: 0.1146 | Loss:   0.0054
Episode 3400 | Feature: loan_percent_income  | Reward:   0.1950 | Acc: 0.7600 | DPG: 0.1400 | Loss:   0.0028
Episode 3500 | Feature: loan_percent_income  | Reward:   0.1917 | Acc: 0.7600 | DPG: 0.1278 | Loss:   0.0034
Episode 3600 | Feature: loan_percent_income  | Reward:   0.2267 | Acc: 0.8000 | DPG: 0.0965 | Loss:   0.0068
Episode 3700 | Feature: loan_percent_income  | Reward:   0.2050 | Acc: 0.7700 | DPG: 0.1227 | Loss:   0.0039
Episode 3800 | Feature: loan_percent_income  | Reward:   0.1950 | Acc: 0.7800 | DPG: 0.0671 | Loss:   0.0172
Episode 3900 | Feature: loan_percent_income  | Reward:   0.2000 | Acc: 0.7333 | DPG: 0.1210 | Loss:   0.0059
Episode 4000 | Feature: loan_percent_income  | Reward:   0.1983 | Acc: 0.7800 | DPG: 0.0831 | Loss:   0.0085
Episode 4100 | Feature: loan_percent_income  | Reward:   0.2183 | Acc: 0.7333 | DPG: 0.1545 | Loss:   0.0079
Episode 4200 | Feature: loan_percent_income  | Reward:   0.1717 | Acc: 0.7533 | DPG: 0.1156 | Loss:   0.0093
Episode 4300 | Feature: loan_percent_income  | Reward:   0.2167 | Acc: 0.7800 | DPG: 0.1167 | Loss:   0.0161
Episode 4400 | Feature: previous_loan_defaults_on_file | Reward:   0.1417 | Acc: 0.7800 | DPG: 0.0735 | Loss:   0.2510
Episode 4500 | Feature: loan_percent_income  | Reward:   0.1783 | Acc: 0.7600 | DPG: 0.0946 | Loss:   0.0253
Episode 4600 | Feature: previous_loan_defaults_on_file | Reward:   0.1400 | Acc: 0.7200 | DPG: 0.1033 | Loss:   0.2141
Episode 4700 | Feature: loan_percent_income  | Reward:   0.2250 | Acc: 0.7567 | DPG: 0.2272 | Loss:   0.0459
Episode 4800 | Feature: loan_percent_income  | Reward:   0.2067 | Acc: 0.7633 | DPG: 0.1720 | Loss:   0.0549
Episode 4900 | Feature: loan_percent_income  | Reward:   0.1817 | Acc: 0.8000 | DPG: 0.0828 | Loss:   0.0091
Episode 5000 | Feature: previous_loan_defaults_on_file | Reward:   0.1267 | Acc: 0.7500 | DPG: 0.0907 | Loss:   0.3377
Episode 5100 | Feature: loan_percent_income  | Reward:   0.1817 | Acc: 0.7233 | DPG: 0.1162 | Loss:   0.0107
Episode 5200 | Feature: loan_percent_income  | Reward:   0.1617 | Acc: 0.8033 | DPG: 0.1324 | Loss:   0.0148
Episode 5300 | Feature: loan_percent_income  | Reward:   0.2450 | Acc: 0.7600 | DPG: 0.1228 | Loss:   0.0887
Episode 5400 | Feature: loan_percent_income  | Reward:   0.2133 | Acc: 0.7500 | DPG: 0.0918 | Loss:   0.0468
Episode 5500 | Feature: loan_percent_income  | Reward:   0.1750 | Acc: 0.7900 | DPG: 0.0847 | Loss:   0.0474
Episode 5600 | Feature: loan_percent_income  | Reward:   0.2083 | Acc: 0.7600 | DPG: 0.1080 | Loss:   0.0128
Episode 5700 | Feature: loan_percent_income  | Reward:   0.1750 | Acc: 0.8000 | DPG: 0.1297 | Loss:   0.0072
Episode 5800 | Feature: loan_percent_income  | Reward:   0.1650 | Acc: 0.7767 | DPG: 0.1066 | Loss:   0.0032
Episode 5900 | Feature: loan_percent_income  | Reward:   0.1983 | Acc: 0.7967 | DPG: 0.0318 | Loss:   0.0136
Episode 6000 | Feature: loan_percent_income  | Reward:   0.1933 | Acc: 0.7833 | DPG: 0.0496 | Loss:   0.0094
Episode 6100 | Feature: loan_percent_income  | Reward:   0.1833 | Acc: 0.7800 | DPG: 0.1100 | Loss:   0.0293
Episode 6200 | Feature: loan_percent_income  | Reward:   0.1850 | Acc: 0.7767 | DPG: 0.0980 | Loss:   0.0195
Episode 6300 | Feature: loan_percent_income  | Reward:   0.1483 | Acc: 0.7833 | DPG: 0.1596 | Loss:   0.0042
Episode 6400 | Feature: loan_percent_income  | Reward:   0.1650 | Acc: 0.8067 | DPG: 0.1228 | Loss:   0.0059
Episode 6500 | Feature: loan_percent_income  | Reward:   0.2133 | Acc: 0.7600 | DPG: 0.1728 | Loss:   0.0129
Episode 6600 | Feature: previous_loan_defaults_on_file | Reward:   0.1400 | Acc: 0.7067 | DPG: 0.0827 | Loss:   0.2282
Episode 6700 | Feature: loan_percent_income  | Reward:   0.1867 | Acc: 0.7900 | DPG: 0.1460 | Loss:   0.0266
Episode 6800 | Feature: loan_percent_income  | Reward:   0.1900 | Acc: 0.7633 | DPG: 0.1413 | Loss:   0.0179
Episode 6900 | Feature: loan_percent_income  | Reward:   0.1983 | Acc: 0.7500 | DPG: 0.2046 | Loss:   0.0359
Episode 7000 | Feature: loan_percent_income  | Reward:   0.1617 | Acc: 0.7600 | DPG: 0.0132 | Loss:   0.0107
Episode 7100 | Feature: loan_percent_income  | Reward:   0.2000 | Acc: 0.7800 | DPG: 0.1193 | Loss:   0.0167
Episode 7200 | Feature: previous_loan_defaults_on_file | Reward:   0.1483 | Acc: 0.7500 | DPG: 0.0907 | Loss:   0.1681
Episode 7300 | Feature: loan_percent_income  | Reward:   0.1917 | Acc: 0.7167 | DPG: 0.1478 | Loss:   0.0197
Episode 7400 | Feature: loan_percent_income  | Reward:   0.2067 | Acc: 0.7833 | DPG: 0.0885 | Loss:   0.0104
Episode 7500 | Feature: loan_percent_income  | Reward:   0.1917 | Acc: 0.7833 | DPG: 0.1228 | Loss:   0.0034
Episode 7600 | Feature: loan_percent_income  | Reward:   0.1767 | Acc: 0.7533 | DPG: 0.0726 | Loss:   0.0040
Episode 7700 | Feature: loan_percent_income  | Reward:   0.1833 | Acc: 0.7467 | DPG: 0.0817 | Loss:   0.0053
Episode 7800 | Feature: previous_loan_defaults_on_file | Reward:   0.1350 | Acc: 0.7700 | DPG: 0.1022 | Loss:   0.2964
Episode 7900 | Feature: previous_loan_defaults_on_file | Reward:   0.1400 | Acc: 0.7433 | DPG: 0.0772 | Loss:   0.2156
Episode 8000 | Feature: loan_percent_income  | Reward:   0.2067 | Acc: 0.7600 | DPG: 0.1400 | Loss:   0.0223
Episode 8100 | Feature: loan_percent_income  | Reward:   0.1950 | Acc: 0.7467 | DPG: 0.1026 | Loss:   0.0168
Episode 8200 | Feature: loan_percent_income  | Reward:   0.1617 | Acc: 0.7700 | DPG: 0.1026 | Loss:   0.0205
Episode 8300 | Feature: loan_percent_income  | Reward:   0.2033 | Acc: 0.7733 | DPG: 0.1652 | Loss:   0.0249
Episode 8400 | Feature: loan_percent_income  | Reward:   0.1850 | Acc: 0.7533 | DPG: 0.1205 | Loss:   0.0313
Episode 8500 | Feature: loan_percent_income  | Reward:   0.1983 | Acc: 0.7600 | DPG: 0.0994 | Loss:   0.0220
Episode 8600 | Feature: loan_percent_income  | Reward:   0.1617 | Acc: 0.7800 | DPG: 0.0539 | Loss:   0.0037
Episode 8700 | Feature: loan_percent_income  | Reward:   0.1867 | Acc: 0.8000 | DPG: 0.0906 | Loss:   0.0129
Episode 8800 | Feature: loan_percent_income  | Reward:   0.2083 | Acc: 0.7467 | DPG: 0.1154 | Loss:   0.0243
Episode 8900 | Feature: loan_percent_income  | Reward:   0.1900 | Acc: 0.7600 | DPG: 0.1226 | Loss:   0.0259
Episode 9000 | Feature: loan_percent_income  | Reward:   0.1883 | Acc: 0.7633 | DPG: 0.0614 | Loss:   0.0108
Episode 9100 | Feature: loan_percent_income  | Reward:   0.1617 | Acc: 0.7667 | DPG: 0.0832 | Loss:   0.0048
Episode 9200 | Feature: loan_percent_income  | Reward:   0.1783 | Acc: 0.7800 | DPG: 0.1079 | Loss:   0.0072
Episode 9300 | Feature: loan_percent_income  | Reward:   0.1867 | Acc: 0.7367 | DPG: 0.0402 | Loss:   0.0088
Episode 9400 | Feature: loan_percent_income  | Reward:   0.1617 | Acc: 0.8100 | DPG: 0.1057 | Loss:   0.0080
Episode 9500 | Feature: loan_percent_income  | Reward:   0.1817 | Acc: 0.7700 | DPG: 0.2208 | Loss:   0.0142
Episode 9600 | Feature: loan_percent_income  | Reward:   0.1783 | Acc: 0.8067 | DPG: 0.1089 | Loss:   0.0130
Episode 9700 | Feature: loan_percent_income  | Reward:   0.1750 | Acc: 0.7867 | DPG: 0.0403 | Loss:   0.0531
Episode 9800 | Feature: loan_percent_income  | Reward:   0.1917 | Acc: 0.7967 | DPG: 0.1439 | Loss:   0.0201
Episode 9900 | Feature: loan_percent_income  | Reward:   0.2017 | Acc: 0.7267 | DPG: 0.1266 | Loss:   0.0473
Episode 10000 | Feature: loan_percent_income  | Reward:   0.2283 | Acc: 0.7467 | DPG: 0.1011 | Loss:   0.0384

All Non-Zero Features (Sorted by DPG):
Feature                  | Avg DPG  | Acc + Fairness
------------------------------------------------------------
1. person_education     | Avg DPG: 0.2165 | Utility Score: 0.8366
2. loan_amnt            | Avg DPG: 0.1765 | Utility Score: 0.8584
3. person_income        | Avg DPG: 0.1722 | Utility Score: 0.8607
4. loan_intent          | Avg DPG: 0.1624 | Utility Score: 0.8648
5. person_home_ownership | Avg DPG: 0.1468 | Utility Score: 0.8358
6. loan_percent_income  | Avg DPG: 0.1083 | Utility Score: 0.8313
7. person_emp_exp       | Avg DPG: 0.0885 | Utility Score: 0.9015
8. person_age           | Avg DPG: 0.0881 | Utility Score: 0.9009
9. credit_score         | Avg DPG: 0.0860 | Utility Score: 0.9028
10. previous_loan_defaults_on_file | Avg DPG: 0.0837 | Utility Score: 0.8244
11. cb_person_cred_hist_length | Avg DPG: 0.0813 | Utility Score: 0.9058
12. loan_int_rate        | Avg DPG: 0.0729 | Utility Score: 0.8889
13. person_gender        | Avg DPG: 0.0404 | Utility Score: 0.9252


3h 7m 30s
PC:
AMD Ryzen 5 5600GT (12) @ 4.67 GHz
MD Radeon Vega Series / Radeon Vega Mobile Series [Integrated]
16gb ram
arch linux

RL_TRAINING_PARAMETERS = {
    "num_episodes": 10000,
    "learning_rate": 1e-3,
    "lambda": 0.5,  # Updates
    "sample_size": 300,  # Number of samples to use for RL training
}